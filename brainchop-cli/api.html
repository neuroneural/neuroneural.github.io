

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; brainchop 0.1.23 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=20522496"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Available Models" href="models.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            brainchop
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-methods">Installation Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#using-pip-recommended">Using pip (Recommended)</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#from-source">From Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#using-docker">Using Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#verification">Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#gpu-support">GPU Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#selecting-models">Selecting Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage.html#list-available-models">List Available Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#using-a-specific-model">Using a Specific Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#skull-stripping">Skull Stripping</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#advanced-options">Advanced Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage.html#batch-processing">Batch Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#image-preprocessing">Image Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#export-options">Export Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#custom-models">Custom Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage.html#local-model-development">Local Model Development</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#file-uri-loading">File URI Loading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#updating-models">Updating Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#common-workflows">Common Workflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage.html#quick-tissue-segmentation">Quick Tissue Segmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#clinical-scan-processing">Clinical Scan Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#atlas-based-parcellation">Atlas-based Parcellation</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#brain-extraction-pipeline">Brain Extraction Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#batch-processing-workflow">Batch Processing Workflow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage.html#out-of-memory">Out of Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#slow-first-run">Slow First Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#model-download-issues">Model Download Issues</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Available Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="models.html#model-overview">Model Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#detailed-model-information">Detailed Model Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="models.html#tissue-fast">tissue_fast</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html#subcortical">subcortical</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html#subcortical-mini">subcortical-mini</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html#dkatlas">DKatlas</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html#mindgrab">mindgrab</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="models.html#model-sources">Model Sources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="models.html#updating-models">Updating Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="models.html#model-architecture-formats">Model Architecture Formats</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#command-line-interface">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#main-functions">Main Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inference">Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postprocessing">Postprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimization">Optimization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-brainchop.utils">Utilities Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.download_model_listing"><code class="docutils literal notranslate"><span class="pre">download_model_listing()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.load_models"><code class="docutils literal notranslate"><span class="pre">load_models()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.update_models"><code class="docutils literal notranslate"><span class="pre">update_models()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.list_models"><code class="docutils literal notranslate"><span class="pre">list_models()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.download"><code class="docutils literal notranslate"><span class="pre">download()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.unwrap_path"><code class="docutils literal notranslate"><span class="pre">unwrap_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.unwrap_model_name"><code class="docutils literal notranslate"><span class="pre">unwrap_model_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.detect_architecture_version"><code class="docutils literal notranslate"><span class="pre">detect_architecture_version()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.find_pth_files"><code class="docutils literal notranslate"><span class="pre">find_pth_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.find_tfjs_files"><code class="docutils literal notranslate"><span class="pre">find_tfjs_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.get_model"><code class="docutils literal notranslate"><span class="pre">get_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.get_model_from_custom_path"><code class="docutils literal notranslate"><span class="pre">get_model_from_custom_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.cleanup"><code class="docutils literal notranslate"><span class="pre">cleanup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.export_classes"><code class="docutils literal notranslate"><span class="pre">export_classes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.crop_to_cutoff"><code class="docutils literal notranslate"><span class="pre">crop_to_cutoff()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.pad_to_original_size"><code class="docutils literal notranslate"><span class="pre">pad_to_original_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.utils.write_output"><code class="docutils literal notranslate"><span class="pre">write_output()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#model-management">Model Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">get_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">get_model_from_custom_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">list_models()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">update_models()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#download-and-cache">Download and Cache</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">download()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">download_model_listing()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">load_models()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#model-detection">Model Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">detect_architecture_version()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">find_pth_files()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">find_tfjs_files()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#image-processing">Image Processing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">crop_to_cutoff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">pad_to_original_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">export_classes()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#model-loaders">Model Loaders</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-brainchop.tiny_meshnet">TinyGrad MeshNet Loader</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.tiny_meshnet.convert_keys"><code class="docutils literal notranslate"><span class="pre">convert_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.tiny_meshnet.qnormalize"><code class="docutils literal notranslate"><span class="pre">qnormalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.tiny_meshnet.set_channel_num"><code class="docutils literal notranslate"><span class="pre">set_channel_num()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.tiny_meshnet.construct_layer"><code class="docutils literal notranslate"><span class="pre">construct_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.tiny_meshnet.MeshNet"><code class="docutils literal notranslate"><span class="pre">MeshNet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.tiny_meshnet.load_meshnet"><code class="docutils literal notranslate"><span class="pre">load_meshnet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">load_meshnet()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-brainchop.tfjs_meshnet">TensorFlow.js MeshNet Loader</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.tfjs_meshnet.MeshNetModel"><code class="docutils literal notranslate"><span class="pre">MeshNetModel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.tfjs_meshnet.ModelContainer"><code class="docutils literal notranslate"><span class="pre">ModelContainer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.tfjs_meshnet.load_tfjs_meshnet"><code class="docutils literal notranslate"><span class="pre">load_tfjs_meshnet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">load_tfjs_meshnet()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-brainchop.types">Model Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.types.PreprocessOp"><code class="docutils literal notranslate"><span class="pre">PreprocessOp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.types.Op"><code class="docutils literal notranslate"><span class="pre">Op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.types.PostprocessOp"><code class="docutils literal notranslate"><span class="pre">PostprocessOp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.types.Preprocess"><code class="docutils literal notranslate"><span class="pre">Preprocess</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.types.Layer"><code class="docutils literal notranslate"><span class="pre">Layer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.types.Postprocess"><code class="docutils literal notranslate"><span class="pre">Postprocess</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.types.Metadata"><code class="docutils literal notranslate"><span class="pre">Metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.types.ModelSpec"><code class="docutils literal notranslate"><span class="pre">ModelSpec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.types.load_spec"><code class="docutils literal notranslate"><span class="pre">load_spec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.types.build_model"><code class="docutils literal notranslate"><span class="pre">build_model()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-brainchop.niimath">NIfTI Math Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.header_data_split"><code class="docutils literal notranslate"><span class="pre">header_data_split()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.read_header_bytes"><code class="docutils literal notranslate"><span class="pre">read_header_bytes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.niimath_dtype"><code class="docutils literal notranslate"><span class="pre">niimath_dtype()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.conform"><code class="docutils literal notranslate"><span class="pre">conform()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.header2dimensions"><code class="docutils literal notranslate"><span class="pre">header2dimensions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.header2endian"><code class="docutils literal notranslate"><span class="pre">header2endian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.set_header_intent"><code class="docutils literal notranslate"><span class="pre">set_header_intent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.set_header_intent_label"><code class="docutils literal notranslate"><span class="pre">set_header_intent_label()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.header2datatype"><code class="docutils literal notranslate"><span class="pre">header2datatype()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.header2dtype"><code class="docutils literal notranslate"><span class="pre">header2dtype()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.niimath_pipe_process"><code class="docutils literal notranslate"><span class="pre">niimath_pipe_process()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.grow_border"><code class="docutils literal notranslate"><span class="pre">grow_border()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.largest_cluster"><code class="docutils literal notranslate"><span class="pre">largest_cluster()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.truncate_header_bytes"><code class="docutils literal notranslate"><span class="pre">truncate_header_bytes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#brainchop.niimath.bwlabel"><code class="docutils literal notranslate"><span class="pre">bwlabel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#conformation-and-preprocessing">Conformation and Preprocessing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">conform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#labeling-operations">Labeling Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">bwlabel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">set_header_intent_label()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mask-operations">Mask Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">grow_border()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#constants-and-configuration">Constants and Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#available-models">Available Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.utils.AVAILABLE_MODELS"><code class="docutils literal notranslate"><span class="pre">AVAILABLE_MODELS</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#model-urls">Model URLs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.utils.BASE_URL"><code class="docutils literal notranslate"><span class="pre">BASE_URL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.utils.MESHNET_BASE_URL"><code class="docutils literal notranslate"><span class="pre">MESHNET_BASE_URL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainchop.utils.MODELS_JSON_URL"><code class="docutils literal notranslate"><span class="pre">MODELS_JSON_URL</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#usage-examples">Usage Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loading-a-model-programmatically">Loading a Model Programmatically</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-custom-models">Using Custom Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batch-processing">Batch Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#image-cropping">Image Cropping</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">brainchop</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<p>This page documents the Python API for BrainChop.</p>
<section id="command-line-interface">
<h2>Command Line Interface<a class="headerlink" href="#command-line-interface" title="Link to this heading"></a></h2>
</section>
<section id="main-functions">
<h2>Main Functions<a class="headerlink" href="#main-functions" title="Link to this heading"></a></h2>
<p>The CLI module provides the main entry point for the command-line tool:</p>
<section id="preprocessing">
<h3>Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading"></a></h3>
</section>
<section id="inference">
<h3>Inference<a class="headerlink" href="#inference" title="Link to this heading"></a></h3>
</section>
<section id="postprocessing">
<h3>Postprocessing<a class="headerlink" href="#postprocessing" title="Link to this heading"></a></h3>
</section>
<section id="output">
<h3>Output<a class="headerlink" href="#output" title="Link to this heading"></a></h3>
</section>
<section id="optimization">
<h3>Optimization<a class="headerlink" href="#optimization" title="Link to this heading"></a></h3>
</section>
</section>
<section id="module-brainchop.utils">
<span id="utilities-module"></span><h2>Utilities Module<a class="headerlink" href="#module-brainchop.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.download_model_listing">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">download_model_listing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#download_model_listing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.download_model_listing" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.load_models">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">load_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#load_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.load_models" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.update_models">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">update_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#update_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.update_models" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.list_models">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">list_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#list_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.list_models" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.download">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#download"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.download" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.unwrap_path">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">unwrap_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#unwrap_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.unwrap_path" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.unwrap_model_name">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">unwrap_model_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#unwrap_model_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.unwrap_model_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.detect_architecture_version">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">detect_architecture_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#detect_architecture_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.detect_architecture_version" title="Link to this definition"></a></dt>
<dd><p>Detect whether a model JSON uses the new or old architecture format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>json_path</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></span>) – Path to the model JSON file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>“new” for new architecture format, “old” for deprecated format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.find_pth_files">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">find_pth_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#find_pth_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.find_pth_files" title="Link to this definition"></a></dt>
<dd><p>New native backend for models</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.find_tfjs_files">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">find_tfjs_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#find_tfjs_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.find_tfjs_files" title="Link to this definition"></a></dt>
<dd><p>Deprecated tfjs weight backend</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.get_model">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#get_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.get_model" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.get_model_from_custom_path">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">get_model_from_custom_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#get_model_from_custom_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.get_model_from_custom_path" title="Link to this definition"></a></dt>
<dd><p>Load a model from custom paths, auto-detecting the architecture format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Path to the model JSON configuration. Can be “.” to load the local model.</p></li>
<li><p><strong>weights_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Path to the model weights (.pth or .bin). Can be “.” to load the local model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded model callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.cleanup">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">cleanup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#cleanup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.cleanup" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.export_classes">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">export_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#export_classes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.export_classes" title="Link to this definition"></a></dt>
<dd><p>Split the model’s output channels and write each as a separate NIfTI
using a pre‐built 352 B header (with vox_offset reset, ext_flag zeroed).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_channels</strong> – tinygrad Tensor of shape (1, C, Z, Y, X)</p></li>
<li><p><strong>header</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></span>) – 352‐byte NIfTI header (bytes), no extensions</p></li>
<li><p><strong>output_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – filename for first channel (e.g. “out.nii.gz”)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.crop_to_cutoff">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">crop_to_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_percent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#crop_to_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.crop_to_cutoff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.pad_to_original_size">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">pad_to_original_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cropped_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(256,</span> <span class="pre">256,</span> <span class="pre">256)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#pad_to_original_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.pad_to_original_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.utils.write_output">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">write_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processed_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#write_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.utils.write_output" title="Link to this definition"></a></dt>
<dd><p>Handle file output operations including niimath commands and subprocess calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processed_data</strong> – Processed segmentation data ready for output</p></li>
<li><p><strong>args</strong> – Command line arguments containing output settings</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="model-management">
<h3>Model Management<a class="headerlink" href="#model-management" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id0">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#get_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id1">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">get_model_from_custom_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#get_model_from_custom_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Load a model from custom paths, auto-detecting the architecture format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Path to the model JSON configuration. Can be “.” to load the local model.</p></li>
<li><p><strong>weights_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Path to the model weights (.pth or .bin). Can be “.” to load the local model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded model callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id2">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">list_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#list_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id3">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">update_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#update_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="download-and-cache">
<h3>Download and Cache<a class="headerlink" href="#download-and-cache" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id4">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#download"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id5">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">download_model_listing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#download_model_listing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id6">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">load_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#load_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="model-detection">
<h3>Model Detection<a class="headerlink" href="#model-detection" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id7">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">detect_architecture_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#detect_architecture_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Detect whether a model JSON uses the new or old architecture format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>json_path</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></span>) – Path to the model JSON file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>“new” for new architecture format, “old” for deprecated format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id8">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">find_pth_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#find_pth_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>New native backend for models</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id9">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">find_tfjs_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#find_tfjs_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>Deprecated tfjs weight backend</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="image-processing">
<h3>Image Processing<a class="headerlink" href="#image-processing" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id10">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">crop_to_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_percent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#crop_to_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id11">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">pad_to_original_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cropped_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(256,</span> <span class="pre">256,</span> <span class="pre">256)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#pad_to_original_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id12">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">export_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/utils.html#export_classes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd><p>Split the model’s output channels and write each as a separate NIfTI
using a pre‐built 352 B header (with vox_offset reset, ext_flag zeroed).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_channels</strong> – tinygrad Tensor of shape (1, C, Z, Y, X)</p></li>
<li><p><strong>header</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></span>) – 352‐byte NIfTI header (bytes), no extensions</p></li>
<li><p><strong>output_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – filename for first channel (e.g. “out.nii.gz”)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="model-loaders">
<h2>Model Loaders<a class="headerlink" href="#model-loaders" title="Link to this heading"></a></h2>
<section id="module-brainchop.tiny_meshnet">
<span id="tinygrad-meshnet-loader"></span><h3>TinyGrad MeshNet Loader<a class="headerlink" href="#module-brainchop.tiny_meshnet" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="brainchop.tiny_meshnet.convert_keys">
<span class="sig-prename descclassname"><span class="pre">brainchop.tiny_meshnet.</span></span><span class="sig-name descname"><span class="pre">convert_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tiny_state_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tiny_meshnet.html#convert_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tiny_meshnet.convert_keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.tiny_meshnet.qnormalize">
<span class="sig-prename descclassname"><span class="pre">brainchop.tiny_meshnet.</span></span><span class="sig-name descname"><span class="pre">qnormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tiny_meshnet.html#qnormalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tiny_meshnet.qnormalize" title="Link to this definition"></a></dt>
<dd><p>Unit interval preprocessing with clipping and safe division for bf16</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.tiny_meshnet.set_channel_num">
<span class="sig-prename descclassname"><span class="pre">brainchop.tiny_meshnet.</span></span><span class="sig-name descname"><span class="pre">set_channel_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tiny_meshnet.html#set_channel_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tiny_meshnet.set_channel_num" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.tiny_meshnet.construct_layer">
<span class="sig-prename descclassname"><span class="pre">brainchop.tiny_meshnet.</span></span><span class="sig-name descname"><span class="pre">construct_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dropout_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gelu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tiny_meshnet.html#construct_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tiny_meshnet.construct_layer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brainchop.tiny_meshnet.MeshNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.tiny_meshnet.</span></span><span class="sig-name descname"><span class="pre">MeshNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tiny_meshnet.html#MeshNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tiny_meshnet.MeshNet" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Configurable MeshNet from <a class="reference external" href="https://arxiv.org/pdf/1612.00940.pdf">https://arxiv.org/pdf/1612.00940.pdf</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tiny_meshnet.MeshNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tiny_meshnet.html#MeshNet.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tiny_meshnet.MeshNet.__init__" title="Link to this definition"></a></dt>
<dd><p>Init</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tiny_meshnet.MeshNet.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tiny_meshnet.html#MeshNet.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tiny_meshnet.MeshNet.normalize" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.tiny_meshnet.load_meshnet">
<span class="sig-prename descclassname"><span class="pre">brainchop.tiny_meshnet.</span></span><span class="sig-name descname"><span class="pre">load_meshnet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tiny_meshnet.html#load_meshnet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tiny_meshnet.load_meshnet" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id13">
<span class="sig-prename descclassname"><span class="pre">brainchop.tiny_meshnet.</span></span><span class="sig-name descname"><span class="pre">load_meshnet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tiny_meshnet.html#load_meshnet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-brainchop.tfjs_meshnet">
<span id="tensorflow-js-meshnet-loader"></span><h3>TensorFlow.js MeshNet Loader<a class="headerlink" href="#module-brainchop.tfjs_meshnet" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.MeshNetModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.tfjs_meshnet.</span></span><span class="sig-name descname"><span class="pre">MeshNetModel</span></span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#MeshNetModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.MeshNetModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.MeshNetModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#MeshNetModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.MeshNetModel.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.MeshNetModel.load_model_spec">
<span class="sig-name descname"><span class="pre">load_model_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#MeshNetModel.load_model_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.MeshNetModel.load_model_spec" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.MeshNetModel.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#MeshNetModel.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.MeshNetModel.normalize" title="Link to this definition"></a></dt>
<dd><p>Normalize the input image based on the configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.MeshNetModel.min_max_normalize">
<span class="sig-name descname"><span class="pre">min_max_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#MeshNetModel.min_max_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.MeshNetModel.min_max_normalize" title="Link to this definition"></a></dt>
<dd><p>Min-max normalization to [0,1] range.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.MeshNetModel.quantile_normalize">
<span class="sig-name descname"><span class="pre">quantile_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qmax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#MeshNetModel.quantile_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.MeshNetModel.quantile_normalize" title="Link to this definition"></a></dt>
<dd><p>Normalize using quantile values.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.MeshNetModel.calculate_padding">
<span class="sig-name descname"><span class="pre">calculate_padding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#MeshNetModel.calculate_padding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.MeshNetModel.calculate_padding" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.MeshNetModel.process_conv_layer">
<span class="sig-name descname"><span class="pre">process_conv_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#MeshNetModel.process_conv_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.MeshNetModel.process_conv_layer" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.ModelContainer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.tfjs_meshnet.</span></span><span class="sig-name descname"><span class="pre">ModelContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#ModelContainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.ModelContainer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.ModelContainer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#ModelContainer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.ModelContainer.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.ModelContainer.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#ModelContainer.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.ModelContainer.normalize" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.tfjs_meshnet.load_tfjs_meshnet">
<span class="sig-prename descclassname"><span class="pre">brainchop.tfjs_meshnet.</span></span><span class="sig-name descname"><span class="pre">load_tfjs_meshnet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#load_tfjs_meshnet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.tfjs_meshnet.load_tfjs_meshnet" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id14">
<span class="sig-prename descclassname"><span class="pre">brainchop.tfjs_meshnet.</span></span><span class="sig-name descname"><span class="pre">load_tfjs_meshnet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/tfjs_meshnet.html#load_tfjs_meshnet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-brainchop.types">
<span id="model-types"></span><h3>Model Types<a class="headerlink" href="#module-brainchop.types" title="Link to this heading"></a></h3>
<p>BrainChop Model Specification
Read-only dataclass specification for model architecture loading</p>
<dl class="py class">
<dt class="sig sig-object py" id="brainchop.types.PreprocessOp">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.types.</span></span><span class="sig-name descname"><span class="pre">PreprocessOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/types.html#PreprocessOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.types.PreprocessOp" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Preprocessing operations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.PreprocessOp.QNORMALIZE">
<span class="sig-name descname"><span class="pre">QNORMALIZE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'qnormalize'</span></em><a class="headerlink" href="#brainchop.types.PreprocessOp.QNORMALIZE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.PreprocessOp.MINMAX">
<span class="sig-name descname"><span class="pre">MINMAX</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'minmax'</span></em><a class="headerlink" href="#brainchop.types.PreprocessOp.MINMAX" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.PreprocessOp.ZSCORE">
<span class="sig-name descname"><span class="pre">ZSCORE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'zscore'</span></em><a class="headerlink" href="#brainchop.types.PreprocessOp.ZSCORE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.PreprocessOp.NONE">
<span class="sig-name descname"><span class="pre">NONE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'none'</span></em><a class="headerlink" href="#brainchop.types.PreprocessOp.NONE" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brainchop.types.Op">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.types.</span></span><span class="sig-name descname"><span class="pre">Op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/types.html#Op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.types.Op" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>All layer operations - matches torch.nn.functional names</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.CONV1D">
<span class="sig-name descname"><span class="pre">CONV1D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'conv1d'</span></em><a class="headerlink" href="#brainchop.types.Op.CONV1D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.CONV2D">
<span class="sig-name descname"><span class="pre">CONV2D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'conv2d'</span></em><a class="headerlink" href="#brainchop.types.Op.CONV2D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.CONV3D">
<span class="sig-name descname"><span class="pre">CONV3D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'conv3d'</span></em><a class="headerlink" href="#brainchop.types.Op.CONV3D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.BATCH_NORM">
<span class="sig-name descname"><span class="pre">BATCH_NORM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'batch_norm'</span></em><a class="headerlink" href="#brainchop.types.Op.BATCH_NORM" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.BATCH_NORM1D">
<span class="sig-name descname"><span class="pre">BATCH_NORM1D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'batch_norm1d'</span></em><a class="headerlink" href="#brainchop.types.Op.BATCH_NORM1D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.BATCH_NORM2D">
<span class="sig-name descname"><span class="pre">BATCH_NORM2D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'batch_norm2d'</span></em><a class="headerlink" href="#brainchop.types.Op.BATCH_NORM2D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.BATCH_NORM3D">
<span class="sig-name descname"><span class="pre">BATCH_NORM3D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'batch_norm3d'</span></em><a class="headerlink" href="#brainchop.types.Op.BATCH_NORM3D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.GROUP_NORM">
<span class="sig-name descname"><span class="pre">GROUP_NORM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'group_norm'</span></em><a class="headerlink" href="#brainchop.types.Op.GROUP_NORM" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.INSTANCE_NORM">
<span class="sig-name descname"><span class="pre">INSTANCE_NORM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'instance_norm'</span></em><a class="headerlink" href="#brainchop.types.Op.INSTANCE_NORM" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.INSTANCE_NORM1D">
<span class="sig-name descname"><span class="pre">INSTANCE_NORM1D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'instance_norm1d'</span></em><a class="headerlink" href="#brainchop.types.Op.INSTANCE_NORM1D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.INSTANCE_NORM2D">
<span class="sig-name descname"><span class="pre">INSTANCE_NORM2D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'instance_norm2d'</span></em><a class="headerlink" href="#brainchop.types.Op.INSTANCE_NORM2D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.INSTANCE_NORM3D">
<span class="sig-name descname"><span class="pre">INSTANCE_NORM3D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'instance_norm3d'</span></em><a class="headerlink" href="#brainchop.types.Op.INSTANCE_NORM3D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.LAYER_NORM">
<span class="sig-name descname"><span class="pre">LAYER_NORM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'layer_norm'</span></em><a class="headerlink" href="#brainchop.types.Op.LAYER_NORM" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.RELU">
<span class="sig-name descname"><span class="pre">RELU</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'relu'</span></em><a class="headerlink" href="#brainchop.types.Op.RELU" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.GELU">
<span class="sig-name descname"><span class="pre">GELU</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'gelu'</span></em><a class="headerlink" href="#brainchop.types.Op.GELU" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.SILU">
<span class="sig-name descname"><span class="pre">SILU</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'silu'</span></em><a class="headerlink" href="#brainchop.types.Op.SILU" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.ELU">
<span class="sig-name descname"><span class="pre">ELU</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'elu'</span></em><a class="headerlink" href="#brainchop.types.Op.ELU" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.LEAKY_RELU">
<span class="sig-name descname"><span class="pre">LEAKY_RELU</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'leaky_relu'</span></em><a class="headerlink" href="#brainchop.types.Op.LEAKY_RELU" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.TANH">
<span class="sig-name descname"><span class="pre">TANH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tanh'</span></em><a class="headerlink" href="#brainchop.types.Op.TANH" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.SIGMOID">
<span class="sig-name descname"><span class="pre">SIGMOID</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sigmoid'</span></em><a class="headerlink" href="#brainchop.types.Op.SIGMOID" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.SOFTMAX">
<span class="sig-name descname"><span class="pre">SOFTMAX</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'softmax'</span></em><a class="headerlink" href="#brainchop.types.Op.SOFTMAX" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.DROPOUT">
<span class="sig-name descname"><span class="pre">DROPOUT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'dropout'</span></em><a class="headerlink" href="#brainchop.types.Op.DROPOUT" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.DROPOUT1D">
<span class="sig-name descname"><span class="pre">DROPOUT1D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'dropout1d'</span></em><a class="headerlink" href="#brainchop.types.Op.DROPOUT1D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.DROPOUT2D">
<span class="sig-name descname"><span class="pre">DROPOUT2D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'dropout2d'</span></em><a class="headerlink" href="#brainchop.types.Op.DROPOUT2D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.DROPOUT3D">
<span class="sig-name descname"><span class="pre">DROPOUT3D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'dropout3d'</span></em><a class="headerlink" href="#brainchop.types.Op.DROPOUT3D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.MAX_POOL1D">
<span class="sig-name descname"><span class="pre">MAX_POOL1D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'max_pool1d'</span></em><a class="headerlink" href="#brainchop.types.Op.MAX_POOL1D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.MAX_POOL2D">
<span class="sig-name descname"><span class="pre">MAX_POOL2D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'max_pool2d'</span></em><a class="headerlink" href="#brainchop.types.Op.MAX_POOL2D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.MAX_POOL3D">
<span class="sig-name descname"><span class="pre">MAX_POOL3D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'max_pool3d'</span></em><a class="headerlink" href="#brainchop.types.Op.MAX_POOL3D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.AVG_POOL1D">
<span class="sig-name descname"><span class="pre">AVG_POOL1D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'avg_pool1d'</span></em><a class="headerlink" href="#brainchop.types.Op.AVG_POOL1D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.AVG_POOL2D">
<span class="sig-name descname"><span class="pre">AVG_POOL2D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'avg_pool2d'</span></em><a class="headerlink" href="#brainchop.types.Op.AVG_POOL2D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.AVG_POOL3D">
<span class="sig-name descname"><span class="pre">AVG_POOL3D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'avg_pool3d'</span></em><a class="headerlink" href="#brainchop.types.Op.AVG_POOL3D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.ADAPTIVE_AVG_POOL1D">
<span class="sig-name descname"><span class="pre">ADAPTIVE_AVG_POOL1D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'adaptive_avg_pool1d'</span></em><a class="headerlink" href="#brainchop.types.Op.ADAPTIVE_AVG_POOL1D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.ADAPTIVE_AVG_POOL2D">
<span class="sig-name descname"><span class="pre">ADAPTIVE_AVG_POOL2D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'adaptive_avg_pool2d'</span></em><a class="headerlink" href="#brainchop.types.Op.ADAPTIVE_AVG_POOL2D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.ADAPTIVE_AVG_POOL3D">
<span class="sig-name descname"><span class="pre">ADAPTIVE_AVG_POOL3D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'adaptive_avg_pool3d'</span></em><a class="headerlink" href="#brainchop.types.Op.ADAPTIVE_AVG_POOL3D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.LINEAR">
<span class="sig-name descname"><span class="pre">LINEAR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'linear'</span></em><a class="headerlink" href="#brainchop.types.Op.LINEAR" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.UPSAMPLE">
<span class="sig-name descname"><span class="pre">UPSAMPLE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'upsample'</span></em><a class="headerlink" href="#brainchop.types.Op.UPSAMPLE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Op.INTERPOLATE">
<span class="sig-name descname"><span class="pre">INTERPOLATE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'interpolate'</span></em><a class="headerlink" href="#brainchop.types.Op.INTERPOLATE" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brainchop.types.PostprocessOp">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.types.</span></span><span class="sig-name descname"><span class="pre">PostprocessOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/types.html#PostprocessOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.types.PostprocessOp" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Postprocessing operations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.PostprocessOp.SOFTMAX">
<span class="sig-name descname"><span class="pre">SOFTMAX</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'softmax'</span></em><a class="headerlink" href="#brainchop.types.PostprocessOp.SOFTMAX" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.PostprocessOp.SIGMOID">
<span class="sig-name descname"><span class="pre">SIGMOID</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sigmoid'</span></em><a class="headerlink" href="#brainchop.types.PostprocessOp.SIGMOID" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.PostprocessOp.ARGMAX">
<span class="sig-name descname"><span class="pre">ARGMAX</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'argmax'</span></em><a class="headerlink" href="#brainchop.types.PostprocessOp.ARGMAX" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.PostprocessOp.NONE">
<span class="sig-name descname"><span class="pre">NONE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'none'</span></em><a class="headerlink" href="#brainchop.types.PostprocessOp.NONE" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brainchop.types.Preprocess">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.types.</span></span><span class="sig-name descname"><span class="pre">Preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/types.html#Preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.types.Preprocess" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Preprocess.op">
<span class="sig-name descname"><span class="pre">op</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#brainchop.types.PreprocessOp" title="brainchop.types.PreprocessOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">PreprocessOp</span></code></a></em><a class="headerlink" href="#brainchop.types.Preprocess.op" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Preprocess.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#brainchop.types.Preprocess.params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.types.Preprocess.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainchop.types.Preprocess.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brainchop.types.Layer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.types.</span></span><span class="sig-name descname"><span class="pre">Layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/types.html#Layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.types.Layer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Layer.op">
<span class="sig-name descname"><span class="pre">op</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#brainchop.types.Op" title="brainchop.types.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a></em><a class="headerlink" href="#brainchop.types.Layer.op" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Layer.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#brainchop.types.Layer.params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Layer.training_only">
<span class="sig-name descname"><span class="pre">training_only</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#brainchop.types.Layer.training_only" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.types.Layer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainchop.types.Layer.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brainchop.types.Postprocess">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.types.</span></span><span class="sig-name descname"><span class="pre">Postprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/types.html#Postprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.types.Postprocess" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Postprocess.op">
<span class="sig-name descname"><span class="pre">op</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#brainchop.types.PostprocessOp" title="brainchop.types.PostprocessOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">PostprocessOp</span></code></a></em><a class="headerlink" href="#brainchop.types.Postprocess.op" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Postprocess.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#brainchop.types.Postprocess.params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.types.Postprocess.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainchop.types.Postprocess.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brainchop.types.Metadata">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.types.</span></span><span class="sig-name descname"><span class="pre">Metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framework</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tinygrad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/types.html#Metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.types.Metadata" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Metadata.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#brainchop.types.Metadata.description" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Metadata.framework">
<span class="sig-name descname"><span class="pre">framework</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'torch'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'tinygrad'</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tinygrad'</span></em><a class="headerlink" href="#brainchop.types.Metadata.framework" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Metadata.input_shape">
<span class="sig-name descname"><span class="pre">input_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#brainchop.types.Metadata.input_shape" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.Metadata.output_classes">
<span class="sig-name descname"><span class="pre">output_classes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#brainchop.types.Metadata.output_classes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.types.Metadata.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framework</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tinygrad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainchop.types.Metadata.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brainchop.types.ModelSpec">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brainchop.types.</span></span><span class="sig-name descname"><span class="pre">ModelSpec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_pass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocessing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/types.html#ModelSpec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.types.ModelSpec" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Complete model specification</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.ModelSpec.version">
<span class="sig-name descname"><span class="pre">version</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#brainchop.types.ModelSpec.version" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.ModelSpec.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#brainchop.types.Metadata" title="brainchop.types.Metadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metadata</span></code></a></em><a class="headerlink" href="#brainchop.types.ModelSpec.metadata" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.ModelSpec.preprocessing">
<span class="sig-name descname"><span class="pre">preprocessing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#brainchop.types.Preprocess" title="brainchop.types.Preprocess"><code class="xref py py-class docutils literal notranslate"><span class="pre">Preprocess</span></code></a></em><a class="headerlink" href="#brainchop.types.ModelSpec.preprocessing" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.ModelSpec.forward_pass">
<span class="sig-name descname"><span class="pre">forward_pass</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a><span class="pre">[</span><a class="reference internal" href="#brainchop.types.Layer" title="brainchop.types.Layer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#brainchop.types.ModelSpec.forward_pass" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainchop.types.ModelSpec.postprocessing">
<span class="sig-name descname"><span class="pre">postprocessing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#brainchop.types.Postprocess" title="brainchop.types.Postprocess"><code class="xref py py-class docutils literal notranslate"><span class="pre">Postprocess</span></code></a></em><a class="headerlink" href="#brainchop.types.ModelSpec.postprocessing" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainchop.types.ModelSpec.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_pass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocessing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainchop.types.ModelSpec.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.types.load_spec">
<span class="sig-prename descclassname"><span class="pre">brainchop.types.</span></span><span class="sig-name descname"><span class="pre">load_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/types.html#load_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.types.load_spec" title="Link to this definition"></a></dt>
<dd><p>Load model specification from JSON file</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#brainchop.types.ModelSpec" title="brainchop.types.ModelSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelSpec</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.types.build_model">
<span class="sig-prename descclassname"><span class="pre">brainchop.types.</span></span><span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/types.html#build_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.types.build_model" title="Link to this definition"></a></dt>
<dd><p>Build executable model from spec and weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Path to JSON specification</p></li>
<li><p><strong>weights_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Path to .pth or .safetensors weights</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable model with loaded weights</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-brainchop.niimath">
<span id="nifti-math-operations"></span><h2>NIfTI Math Operations<a class="headerlink" href="#module-brainchop.niimath" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.header_data_split">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">header_data_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nifti_bytes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#header_data_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.header_data_split" title="Link to this definition"></a></dt>
<dd><p>Splits a NIfTI file’s byte content into header and image data.</p>
<p>This function correctly finds the start of the image data by reading
the ‘vox_offset’ field from the header, providing a robust alternative
to assuming a fixed header size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nifti_bytes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></span>) – The full content of a NIfTI file as a bytes object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(header, image_data).
The ‘header’ includes the standard 348-byte header plus any extensions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing two bytes objects</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the input is too short to contain the vox_offset field
    or if the offset points beyond the data’s boundaries.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.read_header_bytes">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">read_header_bytes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">352</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#read_header_bytes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.read_header_bytes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.niimath_dtype">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">niimath_dtype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#niimath_dtype"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.niimath_dtype" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.conform">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">conform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#conform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.conform" title="Link to this definition"></a></dt>
<dd><p>Conform a NIfTI image to 256³ uint8 using niimath, returning
the volume (256×256×256) and the 352‑byte header.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.header2dimensions">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">header2dimensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header_bytes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#header2dimensions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.header2dimensions" title="Link to this definition"></a></dt>
<dd><p>Extracts the meaningful dimensions (nx, ny, nz, nt, nu, nv, nw)
from a NIfTI header ignoring trailing dimensions of size 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>header_bytes</strong> – A bytes object containing the NIfTI header (at least 352 bytes).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the meaningful dimensions (nx, ny, nz, nt, nu, nv, nw).
Returns an empty tuple if the header_bytes are not valid or too short.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.header2endian">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">header2endian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#header2endian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.header2endian" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.set_header_intent">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">set_header_intent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#set_header_intent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.set_header_intent" title="Link to this definition"></a></dt>
<dd><p>Sets the NIFTI intent code to <cite>intent_code</cite> in the header.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.set_header_intent_label">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">set_header_intent_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#set_header_intent_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.set_header_intent_label" title="Link to this definition"></a></dt>
<dd><p>Sets the NIFTI intent code to ‘label’ (1002) in the header.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.header2datatype">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">header2datatype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#header2datatype"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.header2datatype" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.header2dtype">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">header2dtype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#header2dtype"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.header2dtype" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.niimath_pipe_process">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">niimath_pipe_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#niimath_pipe_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.niimath_pipe_process" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.grow_border">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">grow_border</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#grow_border"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.grow_border" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.largest_cluster">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">largest_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#largest_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.largest_cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.truncate_header_bytes">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">truncate_header_bytes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#truncate_header_bytes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.truncate_header_bytes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainchop.niimath.bwlabel">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">bwlabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">26</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#bwlabel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainchop.niimath.bwlabel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<section id="conformation-and-preprocessing">
<h3>Conformation and Preprocessing<a class="headerlink" href="#conformation-and-preprocessing" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id15">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">conform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#conform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd><p>Conform a NIfTI image to 256³ uint8 using niimath, returning
the volume (256×256×256) and the 352‑byte header.</p>
</dd></dl>

</section>
<section id="labeling-operations">
<h3>Labeling Operations<a class="headerlink" href="#labeling-operations" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id16">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">bwlabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">26</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#bwlabel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id17">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">set_header_intent_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#set_header_intent_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd><p>Sets the NIFTI intent code to ‘label’ (1002) in the header.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="mask-operations">
<h3>Mask Operations<a class="headerlink" href="#mask-operations" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id18">
<span class="sig-prename descclassname"><span class="pre">brainchop.niimath.</span></span><span class="sig-name descname"><span class="pre">grow_border</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/brainchop/niimath.html#grow_border"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
</section>
<section id="constants-and-configuration">
<h2>Constants and Configuration<a class="headerlink" href="#constants-and-configuration" title="Link to this heading"></a></h2>
<section id="available-models">
<h3>Available Models<a class="headerlink" href="#available-models" title="Link to this heading"></a></h3>
<dl class="py data">
<dt class="sig sig-object py" id="brainchop.utils.AVAILABLE_MODELS">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">AVAILABLE_MODELS</span></span><a class="headerlink" href="#brainchop.utils.AVAILABLE_MODELS" title="Link to this definition"></a></dt>
<dd><p>dict() -&gt; new empty dictionary
dict(mapping) -&gt; new dictionary initialized from a mapping object’s</p>
<blockquote>
<div><p>(key, value) pairs</p>
</div></blockquote>
<dl>
<dt>dict(iterable) -&gt; new dictionary initialized as if via:</dt><dd><p>d = {}
for k, v in iterable:</p>
<blockquote>
<div><p>d[k] = v</p>
</div></blockquote>
</dd>
<dt>dict(<a href="#id19"><span class="problematic" id="id20">**</span></a>kwargs) -&gt; new dictionary initialized with the name=value pairs</dt><dd><p>in the keyword argument list.  For example:  dict(one=1, two=2)</p>
</dd>
</dl>
<p>Dictionary containing all available segmentation models with their metadata.</p>
<p>Each model entry contains:</p>
<ul class="simple">
<li><p><strong>folder</strong>: Model storage directory name</p></li>
<li><p><strong>description</strong>: Human-readable model description</p></li>
<li><p><strong>considerations</strong>: Normalization requirements</p></li>
<li><p><strong>parameter_name</strong>: CLI parameter name</p></li>
</ul>
</dd></dl>

</section>
<section id="model-urls">
<h3>Model URLs<a class="headerlink" href="#model-urls" title="Link to this heading"></a></h3>
<dl class="py data">
<dt class="sig sig-object py" id="brainchop.utils.BASE_URL">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">BASE_URL</span></span><em class="property"><span class="w"> </span><span class="pre">=</span> <span class="pre">&quot;https://github.com/neuroneural/brainchop-models/raw/main/&quot;</span></em><a class="headerlink" href="#brainchop.utils.BASE_URL" title="Link to this definition"></a></dt>
<dd><p>str(object=’’) -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.__str__() (if defined)
or repr(object).
encoding defaults to ‘utf-8’.
errors defaults to ‘strict’.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="brainchop.utils.MESHNET_BASE_URL">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">MESHNET_BASE_URL</span></span><em class="property"><span class="w"> </span><span class="pre">=</span> <span class="pre">&quot;https://github.com/neuroneural/brainchop-models/raw/main/meshnet/&quot;</span></em><a class="headerlink" href="#brainchop.utils.MESHNET_BASE_URL" title="Link to this definition"></a></dt>
<dd><p>str(object=’’) -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.__str__() (if defined)
or repr(object).
encoding defaults to ‘utf-8’.
errors defaults to ‘strict’.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="brainchop.utils.MODELS_JSON_URL">
<span class="sig-prename descclassname"><span class="pre">brainchop.utils.</span></span><span class="sig-name descname"><span class="pre">MODELS_JSON_URL</span></span><em class="property"><span class="w"> </span><span class="pre">=</span> <span class="pre">&quot;https://raw.githubusercontent.com/neuroneural/brainchop-cli/main/models.json&quot;</span></em><a class="headerlink" href="#brainchop.utils.MODELS_JSON_URL" title="Link to this definition"></a></dt>
<dd><p>str(object=’’) -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.__str__() (if defined)
or repr(object).
encoding defaults to ‘utf-8’.
errors defaults to ‘strict’.</p>
</dd></dl>

</section>
</section>
<section id="usage-examples">
<h2>Usage Examples<a class="headerlink" href="#usage-examples" title="Link to this heading"></a></h2>
<section id="loading-a-model-programmatically">
<h3>Loading a Model Programmatically<a class="headerlink" href="#loading-a-model-programmatically" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">brainchop.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tinygrad.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Load a model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span><span class="s2">&quot;tissue_fast&quot;</span><span class="p">)</span>

<span class="c1"># Prepare input (BS, 1, H, W, D)</span>
<span class="n">input_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>

<span class="c1"># Run inference</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>

<span class="c1"># Get segmentation labels</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="using-custom-models">
<h3>Using Custom Models<a class="headerlink" href="#using-custom-models" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">brainchop.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_model_from_custom_path</span>

<span class="c1"># Load custom model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">get_model_from_custom_path</span><span class="p">(</span>
    <span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;/path/to/model.json&quot;</span><span class="p">,</span>
    <span class="n">weights_path</span><span class="o">=</span><span class="s2">&quot;/path/to/model.pth&quot;</span>
<span class="p">)</span>

<span class="c1"># Use like any other model</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="batch-processing">
<h3>Batch Processing<a class="headerlink" href="#batch-processing" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">brainchop.cli</span><span class="w"> </span><span class="kn">import</span> <span class="n">preprocess_batch</span><span class="p">,</span> <span class="n">run_batch_inference</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>

<span class="c1"># Prepare arguments</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span><span class="p">(</span>
    <span class="nb">input</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;file1.nii.gz&quot;</span><span class="p">,</span> <span class="s2">&quot;file2.nii.gz&quot;</span><span class="p">],</span>
    <span class="n">crop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">comply</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">ct</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Preprocess batch</span>
<span class="n">batched_tensor</span><span class="p">,</span> <span class="n">volumes</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">crops</span> <span class="o">=</span> <span class="n">preprocess_batch</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

<span class="c1"># Run inference</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">run_batch_inference</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">batched_tensor</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="image-cropping">
<h3>Image Cropping<a class="headerlink" href="#image-cropping" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">brainchop.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">crop_to_cutoff</span><span class="p">,</span> <span class="n">pad_to_original_size</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Load your 3D image</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;brain_volume.npy&quot;</span><span class="p">)</span>

<span class="c1"># Crop to 2nd percentile</span>
<span class="n">cropped</span><span class="p">,</span> <span class="n">coords</span> <span class="o">=</span> <span class="n">crop_to_cutoff</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cutoff_percent</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

<span class="c1"># Process cropped image</span>
<span class="n">processed</span> <span class="o">=</span> <span class="n">some_processing_function</span><span class="p">(</span><span class="n">cropped</span><span class="p">)</span>

<span class="c1"># Restore to original size</span>
<span class="n">restored</span> <span class="o">=</span> <span class="n">pad_to_original_size</span><span class="p">(</span><span class="n">processed</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">original_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="models.html" class="btn btn-neutral float-left" title="Available Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Mike Doan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>